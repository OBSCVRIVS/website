<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Levi Carver</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header class="banner" role="banner" aria-label="Site banner">
  <img src="assets/img/banner_blue_hour.png" alt="Blue hour banner">
</header>

<nav class="site-nav" aria-label="Site">
  <div class="site-nav__inner">
    <a class="brand" href="/">Levi Carver</a>
    <a class="nav-link" href="contact.html">Contact</a>
  </div>
</nav>

<main id="main">
  <!-- HERO -->
  <section class="hero" aria-labelledby="hero-title">
    <img class="avatar" src="assets/img/avatar_anime_blue_hour.png" alt="Portrait of Levi">
    <div class="hero-meta">
      <h1 id="hero-title">Levi Carver</h1>
      <p class="tagline">@levi · Technical Product Specialist · LA</p>
      <nav class="social" aria-label="Social">
        <ul>
          <li><a href="https://linkedin.com/in/levicarver" rel="me noopener" target="_blank">LinkedIn</a></li>
          <li><a href="https://github.com/USERNAME" rel="me noopener" target="_blank">GitHub</a></li>
        </ul>
      </nav>
    </div>
  </section>

  <!-- ABOUT (clamped with toggle) -->
  <section class="about" aria-labelledby="about-title">
    <h2 id="about-title">About</h2>
    <p id="about-text" class="clamp-3">
      I work in tech with a focus on improving digital systems and making them more accessible for everyone.
      I value empathy, open communication, and learning from different perspectives, which guide how I approach challenges both professionally and personally.
      I’m passionate about debate, political news, and strategy games like chess, all of which push me to think critically and see issues from multiple angles.
      At the core of everything I do is a desire to understand people’s experiences and use that understanding to help create meaningful change.
    </p>
    <button id="about-toggle" class="linklike" aria-expanded="false" aria-controls="about-text">more…</button>
  </section>

  <!-- NOTES (tweet-style) -->
  <section class="feed" aria-labelledby="feed-title">
    <h2 id="feed-title">Notes</h2>
    <div id="notes"></div>
    <nav class="pager" aria-label="Pagination">
      <button id="newer" disabled>Newer</button>
      <button id="older" disabled>Older</button>
    </nav>
  </section>
</main>

<footer class="footer" role="contentinfo">
  <small>© 2025 Levi Carver · <a href="contact.html">Contact</a></small>
</footer>

<script>
  // About expand/collapse
  (function () {
    const text = document.getElementById('about-text');
    const btn = document.getElementById('about-toggle');
    btn.addEventListener('click', () => {
      const expanded = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!expanded));
      text.classList.toggle('clamp-3', expanded);
      btn.textContent = expanded ? 'more…' : 'less';
      if (!expanded) text.classList.remove('clamp-3');
    });
  }());

  // Notes render (tweet-style) loading from /api/notes
  (async function () {
    const pageSize = 10;
    let page = 0;
    const container = document.getElementById('notes');
    const newer = document.getElementById('newer');
    const older = document.getElementById('older');
    let notes = [];

    function fmtTime(iso){
      const d = new Date(iso);
      return d.toLocaleString(undefined, { month:'short', day:'numeric' }) + ' · ' +
             d.toLocaleTimeString(undefined, { hour:'numeric', minute:'2-digit' });
    }
    function escapeHtml(s){
      const div = document.createElement('div'); div.innerText = s;
      return div.innerHTML;
    }

    async function load(){
      try {
        const r = await fetch('/api/notes', { headers: { 'Accept':'application/json' } });
        if (!r.ok) throw new Error('Failed to fetch notes');
        notes = await r.json();
        render();
      } catch {
        container.innerHTML = '<p style="color:#aaa">Could not load notes.</p>';
      }
    }

    function render(){
      container.innerHTML = '';
      const start = page * pageSize;
      const slice = notes.slice(start, start + pageSize);
      slice.forEach(n => {
        const card = document.createElement('article');
        card.className = 'tweet';
        card.id = n.id;

        card.innerHTML = `
          <div class="tweet__avatar"><img src="assets/img/avatar_anime_blue_hour.png" alt="" aria-hidden="true"></div>
          <div class="tweet__body">
            <header class="tweet__head">
              <span class="name">Levi Carver</span>
              <span class="handle">@levi</span>
              <span class="dot" aria-hidden="true">·</span>
              <time datetime="${n.created_at}">${fmtTime(n.created_at)}</time>
            </header>
            <div class="tweet__text">${escapeHtml(n.body)}</div>
            <div class="tweet__actions">
              <a class="permalink" href="notes/${n.id}" aria-label="Permalink">Permalink</a>
            </div>
          </div>
        `;

        card.addEventListener('click', (ev) => {
          if (ev.target.closest('a,button')) return;
          card.classList.toggle('expanded');
        });

        container.appendChild(card);
      });

      newer.disabled = page === 0;
      older.disabled = (start + pageSize) >= notes.length;
    }

    newer.addEventListener('click', ()=>{ if(page>0){ page--; render(); }});
    older.addEventListener('click', ()=>{ if((page+1)*pageSize < notes.length){ page++; render(); }});

    await load();
  }());
</script>
</body>
</html>
